<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div id="app">

</div>
<script>

    var penjat;
    function init() {

        var penjat = new Penjat();
        penjat.init();

    }

    //Models
    function Lletra(valor,estat) {
        // Estats: NO_SELECCIONAT,OK,KO
        this.valor = valor;
        this.estat = estat;
        this.jugar = function (){
            //innerHTML cull es valor de dedins es tag button
            console.log("Button", this.valor);
            //Jugar amb lletra(this.innerHTML)
            penjat.jugar(this.valor);
            //Amb de canviar de funcio pintar de lletra, perque pinti si es correcte o no

            //repintar la paraula
            //actualitzar imatge si fa falta

        }
        this.pintar = function(lletra) {
            if (this.estat ==="OK"){
                return `<button disabled style="background: green">${this.valor}</button>`;
            }else if(this.estat === "KO"){
                return `<button disabled style="background: red">${this.valor}</button>`;
            }else {
                return `<button>${this.valor}</button>`;
            }


            var buttons = document.querySelectorAll("button");

            for (var i = 0; i < buttons.length; i++) {

                buttons[i].addEventListener('click',function (){
                });
            }
        }
    }
    function Paraula(lletres) {

        this.lletres = lletres;
        this.pintar = function () {
            var result = [];
            for (var i = 0; i < this.lletres.length; i++) {
                if (this.lletres[i].estat === "OK"){
                    result.push(this.lletres[i].valor);
                }else {
                    result.push("__")
                }
            }
            document.querySelector("#app").innerHTML += result.join(" ");
        }
    }

    function Penjat(){
        this.paraula;
        this.lletres = [];
        this.init = function (){

            var lletres = "abcdefghijklmnopqrstuvwxyz".split("");

            for (let i = 0; i < lletres.length; i++) {
                var lletra = new Lletra(lletres[i],"NO_SELECCIONAT");
                this.lletres.push(lletra);
            }
            console.log(this.lletres);
            var paraules = ["casa","moix","taula","vinil"];
            var paraula = paraules[Math.floor(Math.random()*paraules.length)];

            var lletresParaula = [];

            for (var i = 0; i < paraula.length; i++) {
                for (var j = 0; j < lletres.length; j++) {
                    if (paraula[i] === this.lletres[j].valor){
                        lletresParaula.push(this.lletres[j]);
                    }
                }
            }
            this.paraula = new Paraula(lletresParaula);

            this.pintar();
        }
        this.jugar = function (lletra){

            var lletraSeleccionada;

            for (var i = 0; i < this.paraula.lletres.length; i++) {

               if(this.lletres[i].valor === lletra){

                   lletraSeleccionada = this.lletres[i];
                   break;
               }
            }
            var trobat = false;
            for (var i = 0; i < this.paraula.lletres.length; i++) {
                if(this.paraula.lletres[i] === lletraSeleccionada){
                    trobat = true;
                    break;
                }

            }
            trobat === true?lletraSeleccionada.estat="OK":lletraSeleccionada.estat="KO";
            /*
            if (trobat){
                lletraSeleccionada.estat = "OK";
            }else {
                lletraSeleccionada.estat = "KO";
            }

             */
        }
        this.pintar = function (){

            document.querySelector("#app").innerHTML = '<div id="imatge"></div>';
            document.querySelector("#app").innerHTML += '<div id="lletres"></div>';
            document.querySelector("#app").innerHTML += '<div id="paraula"></div>';

            //Pintar l'imatge

            //Pintar les lletres

            for (var i = 0; i < this.lletres.length; i++) {
                document.querySelector("#lletres").innerHTML += this.lletres[i].pintar();
            }
            //Pintar la paraula
        }

    }

    //Vistes
    function pintaImg(num) {
        document.querySelector('#app').innerHTML += `<img src="img/${num}.PNG" alt="penjat">`;
    }
    function pintaLletra(lletra) {
        return document.querySelector('#app').innerHTML += `<button onclick="play('${lletra}')">${lletra}</button>`;
    }
    function init() {
        penjat = new Penjat();
        penjat.init();
        penjat.pintar();

    }
    init();
</script>
</body>
</html>