<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div id="app">
    <h2>Cercador de  ciutats del m√≥n</h2>
    <input id="cercador" type="text">
    <div id="ciutats"></div>
</div>
<script type="module">

    import {CiutatControlador} from "../Controlador/CiutatControlador.js";

    (async () =>{
        const ciutatsControlador = new CiutatControlador();
        const ciutats = await ciutatsControlador.findAllCiutats();

        cercador(ciutats);

    })();

    function pintarCiutats(ciutats, container){

        const tableElement = document.createElement("TABLE");

        for (const ciutat of ciutats.slice(0,15)) {

            const trElement = document.createElement("TR");
            const tdElementC = document.createElement("TD");
            const tdElementP = document.createElement("TD");

            //Ciutat
            tdElementC.innerText = ciutat.getNom();
            trElement.appendChild(tdElementC);

            //Pais
            tdElementP.innerText = ciutat.getPais();
            trElement.appendChild(tdElementP);

            tableElement.appendChild(trElement);

        }
        container.appendChild(tableElement);

    }

    function cercador(ciutats) {

        const container = document.querySelector("#ciutats");

        document.querySelector("#cercador").addEventListener("input", (ev) =>{

            const caracters = ev.target.value;

            if(caracters.length >= 3){

                container.innerHTML = "";
                pintarCiutats(ciutats.filter(c => c.getNom().toLowerCase().match(caracters.toLowerCase())), container);
            }
        })
        pintarCiutats(ciutats,container);
    }


</script>
</body>
</html>