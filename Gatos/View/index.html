<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div id="app"></div>

<script type="module">

    "use strict"

    import {CatListController} from "../Controller/CatListController.js";


    (async () => {

        const raza = new CatListController();
        const breeds = await raza.findAllBeeds();
        const moixos = await raza.findAllMoixos();

        console.log(breeds);
        console.log(moixos);
        pintraLayout();
        pintarBreeds(breeds,moixos);
    })();

    function pintraLayout(){
        const ulBreeds = document.createElement("UL");
        ulBreeds.id="breeds";
        const divCats = document.createElement("DIV")
        divCats.id="cats";

        const app = document.querySelector("#app");
        app.appendChild(ulBreeds);
        app.appendChild(divCats);
    }
    function pintarBreeds(breeds,moixos) {

        const ul = document.querySelector("#breeds");
        for (const breed of breeds) {

            const li = document.createElement("LI");
            li.innerHTML = breed.getNom();
            li.addEventListener('click',() =>{

                const moixosFiltrats = moixos.filter(m =>{

                    let trobat = false;
                    m.getRaces()

                    for (const racaMoix of m.getRaces()) {
                        if(racaMoix.getId() === breed.getId()){

                            trobat = true;
                        }
                    }
                    return trobat;
                });
                pintarMoixos(moixosFiltrats)
            })
            ul.appendChild(li);
        }
    }

    function pintarMoixos(moixos) {

        const container = document.querySelector("#cats");
        container.innerHTML = '';
        for (const moix of moixos) {
            const  divMoix = document.createElement("DIV");
            const imgMoix = document.createElement("IMG");
            imgMoix.src = moix.getUrl();

            divMoix.appendChild(imgMoix);
            container.appendChild(divMoix);
        }
    }

</script>
</body>
</html>